# üìù PANDORA Logging Fix v4.2 - Local Logs

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞ (v4.1)
–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤ `%APPDATA%\PANDORA\logs\` - –Ω–∞ –≥–ª—É–±–æ–∫–æ –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø–∞–ø–∫–µ. –≠—Ç–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥–µ–ø–ª–æ—è.

### –†–µ—à–µ–Ω–∏–µ (v4.2)
–õ–æ–≥–∏ —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è **—Ä—è–¥–æ–º —Å EXE** –≤ –ø–∞–ø–∫–µ `dist/logs/` (–∏–ª–∏ `build/PANDORA/logs/` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–±–æ—Ä–∫–∏).

## üìÇ –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```
dist/
‚îú‚îÄ‚îÄ PANDORA/
‚îÇ   ‚îú‚îÄ‚îÄ PANDORA.exe              ‚Üê –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ logs/                     ‚Üê –ü–∞–ø–∫–∞ –ª–æ–≥–æ–≤ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ splash.log            ‚Üê –õ–æ–≥–∏ splash screen
‚îÇ   ‚îî‚îÄ‚îÄ [other files]
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –õ–æ–≥–∏ —Ä—è–¥–æ–º —Å EXE - –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –õ–µ–≥–∫–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
- ‚úÖ –ù–µ –∑–∞–≥—Ä–æ–º–æ–∂–¥–∞–µ—Ç %APPDATA%
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö
- ‚úÖ –ü—Ä–æ—â–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### splash_screen_pro.py (v4.2)

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—É—Ç–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**

```python
# –î–û (v4.1) - —Å–∏—Å—Ç–µ–º–Ω–∞—è –ø–∞–ø–∫–∞
self.log_file = Path(os.environ.get("APPDATA", ".")) / "PANDORA" / "logs" / "splash.log"

# –ü–û–°–õ–ï (v4.2) - —Ä—è–¥–æ–º —Å EXE
if getattr(sys, 'frozen', False):
    # –ï—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω –∫–∞–∫ EXE (PyInstaller)
    base_dir = Path(sys.executable).parent
else:
    # –ï—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç Python
    base_dir = Path(__file__).parent

self.log_file = base_dir / "logs" / "splash.log"
self.log_file.parent.mkdir(parents=True, exist_ok=True)
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–ø—É—â–µ–Ω –ª–∏ –∫–æ–¥ –∫–∞–∫ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π EXE –∏–ª–∏ –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç Python
2. –ï—Å–ª–∏ EXE: `sys.executable.parent` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–∞–ø–∫—É —Å PANDORA.exe
3. –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç: `__file__.parent` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–∞–ø–∫—É —Å –∏—Å—Ö–æ–¥–Ω—ã–º —Ñ–∞–π–ª–æ–º
4. –°–æ–∑–¥–∞—ë—Ç –ø–∞–ø–∫—É `logs/` –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
5. –õ–æ–≥–∏—Ä—É–µ—Ç –≤ `logs/splash.log`

## üõ†Ô∏è –£—Ç–∏–ª–∏—Ç—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤

### view_splash_logs.py (–û–±–Ω–æ–≤–ª–µ–Ω)

–¢–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç –ª–æ–≥–∏ –≤:
1. `../dist/PANDORA/logs/splash.log`
2. `./build/PANDORA/logs/splash.log`
3. `[script_dir]/dist/PANDORA/logs/splash.log`

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Ç–∏–ª–∏—Ç—É –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤
python view_splash_logs.py
```

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π

```python
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
splash.add_log("Starting backend server", "info")

# –£—Å–ø–µ—Ö
splash.add_log("Backend started successfully", "success")

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
splash.add_log("Warning: Service running slowly", "warning")

# –û—à–∏–±–∫–∞ (—Å 10-—Å–µ–∫—É–Ω–¥–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π)
splash.add_log("Error: Connection failed", "error")
splash.close(error_delay=True)  # 10 —Å–µ–∫—É–Ω–¥ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
```

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

```
[HH:MM:SS] [TYPE] Message
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
[14:23:45] [INFO] Starting PANDORA application
[14:23:46] [SUCCESS] Backend server initialized
[14:23:47] [STEP] Loading AI models...
[14:23:50] [SUCCESS] AI models loaded
[14:23:51] [SUCCESS] Frontend ready
[14:23:52] [SUCCESS] Application ready - opening window
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ EXE
–û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–ø–∫—É –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è `PANDORA.exe`:
```
dist/PANDORA/logs/splash.log
```

### 2. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ —É—Ç–∏–ª–∏—Ç—É
```bash
python view_splash_logs.py
```

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Ä—É—á–Ω—É—é
- Windows: `dist\PANDORA\logs\splash.log`
- Linux/Mac: `dist/PANDORA/logs/splash.log`

## üêõ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –õ–æ–≥–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–∞–≤ –∑–∞–ø–∏—Å–∏ –≤ –ø–∞–ø–∫—É dist

**–†–µ—à–µ–Ω–∏–µ:** 
```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
icacls "dist\PANDORA" /grant:r "Users:(F)" /T
```

### –õ–æ–≥–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–≥–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ –º–Ω–æ–≥–æ –æ—à–∏–±–æ–∫

**–†–µ—à–µ–Ω–∏–µ:** 
```python
# –í launcher.py - –æ—á–∏—â–∞—Ç—å –ª–æ–≥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
old_log_file = base_dir / "logs" / "splash.log"
if old_log_file.exists() and old_log_file.stat().st_size > 5_000_000:  # 5MB
    old_log_file.unlink()
```

### "Permission denied" –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–æ–≤
**–ü—Ä–∏—á–∏–Ω–∞:** –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ñ–∞–π–ª

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –í _write_log_file() –¥–æ–±–∞–≤–∏—Ç—å retry
for attempt in range(3):
    try:
        with open(self.log_file, "a", encoding="utf-8") as f:
            f.write(message + "\n")
        break
    except Exception as e:
        if attempt < 2:
            time.sleep(0.1)  # –ü–æ–¥–æ–∂–¥–∞—Ç—å –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å
        else:
            print(f"Failed to write log: {e}", file=sys.stderr)
```

## üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

### GitHub Actions
```yaml
- name: Collect logs
  if: failure()
  run: |
    if (Test-Path "dist/PANDORA/logs/splash.log") {
      Get-Content "dist/PANDORA/logs/splash.log"
    }
```

### Azure DevOps
```yaml
- task: PublishBuildArtifacts@1
  condition: failed()
  inputs:
    pathToPublish: 'dist/PANDORA/logs'
    artifactName: 'crash-logs'
```

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–£–ª—É—á—à–µ–Ω–∏—è v4.1 ‚Üí v4.2:**
- ‚úÖ –ü—É—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–∫—Ä–∞—â—ë–Ω —Å 60 —Å–∏–º–≤–æ–ª–æ–≤ –¥–æ 20
- ‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–≥–∞–º: –≤ 2x –±—ã—Å—Ç—Ä–µ–µ
- ‚úÖ –†–∞–∑–º–µ—Ä EXE: –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
- ‚úÖ –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏: –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: 100% –æ–±—Ä–∞—Ç–Ω–∞—è

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- `docs/DIAGNOSTICS_AND_LOGGING.md` - –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- `docs/LOGGING_IMPROVEMENTS_v4.1.md` - –ò—Å—Ç–æ—Ä–∏—è —É–ª—É—á—à–µ–Ω–∏–π
- `docs/BUILD_AND_DEPLOYMENT_GUIDE.md` - –ì–∞–π–¥ –ø–æ —Å–±–æ—Ä–∫–µ –∏ –¥–µ–ø–ª–æ—é

---

**–í–µ—Ä—Å–∏—è:** 4.2 (2025-12-10)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:** Windows 11, Python 3.10.11, PyInstaller 6.17.0
